%\documentclass{beamer}
\documentclass[xcolor=dvipsnames]{beamer}

\usecolortheme[named=brown]{structure}
\useoutertheme{infolines}
%\usefonttheme{serif}
\usefonttheme[stillsansseriftext]{serif}
%\usetheme{Singapore}
\usetheme[height=7mm]{Madrid}
\setbeamertemplate{navigation symbols}{}

%-------------------------------------------------------------------------------
% get epsf.tex file, for encapsulated postscript files:
\input epsf
%-------------------------------------------------------------------------------
% macro for Postscript figures the easy way
% usage:  \postscript{file.ps}{scale}
% where scale is 1.0 for 100%, 0.5 for 50% reduction, etc.
%

\newcommand{\postscript}[2]
{\setlength{\epsfxsize}{#2\hsize}
\centerline{\epsfbox{#1}}}
%-------------------------------------------------------------------------------

\usepackage{graphics}
\usepackage{color}
\usepackage{epsfig}
\usepackage{microtype}
\usepackage{listings}
\lstset{
  language=C++,
  basicstyle=\small}

\renewcommand{\thefootnote}{}

\title[Amesos2]{Amesos2: Common Interface to Direct Solvers}
\author[Bavier, Boman, Rajamanickam]{Eric Bavier and Erik Boman and Siva Rajamanickam}
\institute[]{
Sandia National Laboratories
}
\date[]{July 6, 2011}


\begin{document}

\begin{frame}[plain]
  \titlepage
  \footnote{\tiny{Sandia is a multiprogram laboratory operated by Sandia Corporation, a wholly owned subsidiary of Lockheed Martin, for the United States Department of Energy'â€™s National Nuclear Security Administration under contract DE-AC04-94AL85000.}}
\end{frame}

\section{Introduction}

\begin{frame}
  \frametitle{Amesos2 Motivation}
  
  \begin{itemize}
  \item Common Interface for direct solvers.
    \medskip
  \item Support a variety of scalar and ordinal datatypes
    \medskip
  \item Support Epetra and Tpetra data structures and allow a design that can
    extend to other matrix types (for eg.: PetSc matrix, compressed column
    matrix)
    \medskip
  \item Revisit Amesos design choices and redesign to easily support more
    solvers and matrix types.
  \end{itemize}
    
\end{frame}

\section{Design}

\begin{frame}
  \frametitle{Use-case Considerations}
  %% - Multiple datatypes (scalar/ordinal as well as matrix/vector)
  %% - Novice Users
  %% - ``Expert'' Users
\end{frame}

\section{Examples}

\begin{frame}[fragile]          % ``fragile'' for slides with verbatim
  \frametitle{Use Case 1: Simple Solve.}
  \begin{lstlisting}
RCP<MAT> A; RCP<MV> X; RCP<MV> B;
// initialize A and B
RCP<Solve<MAT,MV> > solver = Amesos::create(A,X,B);
solver->solve(); // solution placed in X
  \end{lstlisting}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Typical Usage: Preorder, Symbolic, Numeric, Solve}
  \begin{lstlisting}
RCP<MAT> A; RCP<MV> X; RCP<MV> B;
// initialize A and B
RCP<Solve<MAT,MV> > solver = Amesos::create(A,X,B);
solver->preOrdering();
solver->symbolicFactorization();
solver->numericFactorization();
solver->solve();
  \end{lstlisting}
\end{frame}

\begin{frame}
  \frametitle{Solver Interface and Creating Solver}
\end{frame}

\begin{frame}
  \frametitle{Amesos2 Parameters vs Solver Parameters}
\end{frame}

\begin{frame}
  \frametitle{Amesos2 Parameters vs Solver Parameters}
\end{frame}

\begin{frame}
  \frametitle{Support for New Solvers}
\end{frame}

\begin{frame}
  \frametitle{Support for New Matrices and Multivectors}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Expert Usage}
  \framesubtitle{Releasing $A$ after numeric factorization}
  \begin{lstlisting}
RCP<MAT> A;
// Get A from somewhere
RCP<Solver<MAT,MV> > solver = Amesos::create("SuperLU",A);
Teuchos::ParameterList params("Amesos2");
params.sublist("SuperLU").set("IterRefine","DOUBLE");
params.sublist("SuperLU").set("ColPerm","MMD_AT_PLUS_A");
solver->setParameters(params);
solver->symbolicFactorization().numericFactorization();
A = Teuchos::null;          // no longer need A
solver.setA(Teuchos::null); // tell solver to release A
RCP<MV> X; RCP<MV> B;
// do some other work, finally get B's values
solver->solve(X,B);         // solution placed in X
// do some more work and get new values in B
solver->solve(X,B);
  \end{lstlisting}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Expert Usage}
  \framesubtitle{Reusing the solver for a different matrix}
  \begin{lstlisting}
RCP<MAT> A1, A2;
// initialize A1, A2, and B
RCP<Solver<MAT,MV> > solver = Amesos::create(A1,X,B);
solver->solve(); // solution in X
solver->setA(A2);
solver->solve(); // refactorizes first
  \end{lstlisting}
\end{frame}


\begin{frame}
  \frametitle{Internal Design: Solver Hierarchy}
\end{frame}

\begin{frame}
  \frametitle{Internal Design: MatrixAdapter Hierarchy}
\end{frame}

\begin{frame}
  \frametitle{Future Work}
  \begin{itemize}
  \item Need better support to do ordering: Zoltan2 will provide both
    graph partitoning based and minimum degree based orderings.
  \item Need to support more solvers and matrix types.
  \end{itemize}
\end{frame}

\end{document}
